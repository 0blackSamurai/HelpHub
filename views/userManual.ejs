<%- include('./partials/header') %>

<div class="manual-container">
    <div class="manual-header">
        <h1><i class="fas fa-book"></i> HelpHub User Manual</h1>
    </div>
    
    <div class="manual-content">
        <div class="toc">
            <div class="toc-header">Table of Contents</div>
            <ul>
                <li><a href="#general">General Information</a></li>
                
                <% if (userRole === 'User') { %>
                    <li><a href="#user-guide">User Guide</a></li>
                    <li><a href="#create-ticket">Creating Tickets</a></li>
                    <li><a href="#track-ticket">Tracking Your Tickets</a></li>
                <% } %>
                
                <% if (userRole === '1st Line' || userRole === '2nd Line') { %>
                    <li><a href="#support-guide">Support Staff Guide</a></li>
                    <li><a href="#manage-tickets">Managing Assigned Tickets</a></li>
                    <li><a href="#update-status">Updating Ticket Status</a></li>
                    <li><a href="#communication">Communication Best Practices</a></li>
                <% } %>
                
                <% if (userRole === '2nd Line') { %>
                    <li><a href="#advanced-support">Advanced Support Techniques</a></li>
                <% } %>
                
                <% if (userRole === 'Admin') { %>
                    <li><a href="#admin-guide">Administrator Guide</a></li>
                    <li><a href="#user-management">User Management</a></li>
                    <li><a href="#ticket-assignment">Ticket Assignment</a></li>
                    <li><a href="#analytics">Analytics and Reporting</a></li>
                <% } %>
            </ul>
        </div>
        
        <div class="manual-sections">
            <section id="general">
                <h2>General Information</h2>
                <p>Welcome to HelpHub, your ticket management system. This user manual will guide you through using the platform according to your role.</p>
                
                <h3>Navigation</h3>
                <p>The main navigation menu is at the top of every page. It provides access to:</p>
                <ul>
                    <li>Home - Return to the main page</li>
                    <li>Dashboard - Access your role-specific dashboard</li>
                    <li>Profile - View your account and tickets</li>
                    <li>Notifications - View system notifications and updates</li>
                    <li>Help - Access this user manual</li>
                </ul>
                
                <h3>Ticket Statuses</h3>
                <div class="status-explanation">
                    <div class="status-item">
                        <span class="status-badge status-åpen">Open</span>
                        <p>A new ticket that hasn't been assigned or worked on yet.</p>
                    </div>
                    <div class="status-item">
                        <span class="status-badge status-under-arbeid">In Progress</span>
                        <p>The ticket has been assigned and is currently being worked on.</p>
                    </div>
                    <div class="status-item">
                        <span class="status-badge status-løst">Resolved</span>
                        <p>A solution has been provided, but the ticket hasn't been closed yet.</p>
                    </div>
                    <div class="status-item">
                        <span class="status-badge status-closed">Closed</span>
                        <p>The ticket has been fully resolved and closed.</p>
                    </div>
                </div>
                
                <h3>Priority Levels</h3>
                <div class="status-explanation">
                    <div class="status-item">
                        <span class="priority-badge priority-low">Low</span>
                        <p>Minor issues that don't significantly impact operations.</p>
                    </div>
                    <div class="status-item">
                        <span class="priority-badge priority-medium">Medium</span>
                        <p>Issues that affect productivity but have workarounds.</p>
                    </div>
                    <div class="status-item">
                        <span class="priority-badge priority-high">High</span>
                        <p>Critical issues that severely impact operations.</p>
                    </div>
                </div>
            </section>
            
            <% if (userRole === 'User') { %>
                <section id="user-guide">
                    <h2>User Guide</h2>
                    <p>As a user, you can create, track, and communicate about your support tickets.</p>
                    
                    <h3>Your Profile</h3>
                    <p>Your profile page displays all your tickets and their current status. You can access it by clicking on "Profile" in the top navigation.</p>
                    
                    <div class="guide-img">
                        <img src="/images/manual/profile-view.png" alt="Profile View" onerror="this.style.display='none'">
                        <p class="caption">Profile page showing your tickets</p>
                    </div>
                </section>
                
                <section id="create-ticket">
                    <h2>Creating Tickets</h2>
                    <p>Follow these steps to create a new support ticket:</p>
                    
                    <div class="steps">
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>Navigate to Create Ticket</h4>
                                <p>Click on the "Create New Ticket" button on your Profile page or dashboard.</p>
                            </div>
                        </div>
                        
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>Fill in the Ticket Details</h4>
                                <p>Provide a clear, descriptive title that summarizes your issue.</p>
                                <p>Write a detailed description explaining the problem, including:</p>
                                <ul>
                                    <li>What you were trying to do</li>
                                    <li>What happened instead</li>
                                    <li>Any error messages you received</li>
                                    <li>Steps to reproduce the issue</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4>Select Category and Priority</h4>
                                <p>Choose the appropriate category for your issue:</p>
                                <ul>
                                    <li><strong>Bug</strong>: Something isn't working correctly</li>
                                    <li><strong>Feature Request</strong>: Suggestion for new functionality</li>
                                    <li><strong>Support</strong>: Need help using the system</li>
                                </ul>
                                <p>Set the priority based on how critical the issue is to your work.</p>
                            </div>
                        </div>
                        
                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h4>Submit the Ticket</h4>
                                <p>Click the "Create Ticket" button to submit. You'll be redirected to your profile where you can see your new ticket.</p>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section id="track-ticket">
                    <h2>Tracking Your Tickets</h2>
                    <p>You can track the progress of your tickets in several ways:</p>
                    
                    <h3>Viewing Ticket Details</h3>
                    <p>Click on any ticket in your profile to see its details, including:</p>
                    <ul>
                        <li>Current status</li>
                        <li>Support staff assigned (if any)</li>
                        <li>All comments and communications</li>
                    </ul>
                    
                    <h3>Adding Comments</h3>
                    <p>You can add comments to provide additional information or respond to questions from support staff:</p>
                    <ol>
                        <li>Open the ticket by clicking on it in your profile</li>
                        <li>Scroll to the bottom of the ticket view</li>
                        <li>Type your comment in the text box</li>
                        <li>Click "Submit" to add your comment</li>
                    </ol>
                    
                    <h3>Updating Tickets</h3>
                    <p>You can update your ticket's details using the "Update Ticket" button at the bottom of the ticket view.</p>
                    
                    <h3>Notifications</h3>
                    <p>You'll receive notifications (bell icon in the top navigation) when:</p>
                    <ul>
                        <li>Your ticket status changes</li>
                        <li>Support staff comments on your ticket</li>
                        <li>Your ticket is assigned to a support staff member</li>
                    </ul>
                </section>
            <% } %>
            
            <% if (userRole === '1st Line' || userRole === '2nd Line') { %>
                <section id="support-guide">
                    <h2>Support Staff Guide</h2>
                    <p>As a <%= userRole %> support staff member, your role is to effectively manage and resolve tickets assigned to you.</p>
                    
                    <h3>Support Dashboard</h3>
                    <p>Your dashboard provides an overview of all tickets assigned to you, along with key metrics:</p>
                    <ul>
                        <li>Total assigned tickets</li>
                        <li>Tickets in progress</li>
                        <li>Resolved tickets</li>
                        <li>Resolution rate</li>
                    </ul>
                    <p>You can also see other <%= userRole %> tickets that haven't been assigned to you yet.</p>
                </section>
                
                <section id="manage-tickets">
                    <h2>Managing Assigned Tickets</h2>
                    
                    <h3>Ticket Workflow</h3>
                    <p>Follow this general workflow for handling tickets:</p>
                    
                    <div class="workflow">
                        <div class="workflow-item">
                            <div class="workflow-icon"><i class="fas fa-clipboard-check"></i></div>
                            <div class="workflow-text">
                                <h4>1. Review</h4>
                                <p>Carefully read the ticket description and any attached information.</p>
                            </div>
                        </div>
                        
                        <div class="workflow-arrow"><i class="fas fa-arrow-down"></i></div>
                        
                        <div class="workflow-item">
                            <div class="workflow-icon"><i class="fas fa-tasks"></i></div>
                            <div class="workflow-text">
                                <h4>2. Prioritize</h4>
                                <p>Verify the priority is correct based on impact and urgency.</p>
                            </div>
                        </div>
                        
                        <div class="workflow-arrow"><i class="fas fa-arrow-down"></i></div>
                        
                        <div class="workflow-item">
                            <div class="workflow-icon"><i class="fas fa-comments"></i></div>
                            <div class="workflow-text">
                                <h4>3. Communicate</h4>
                                <p>Add a comment acknowledging the ticket and asking for any additional information.</p>
                            </div>
                        </div>
                        
                        <div class="workflow-arrow"><i class="fas fa-arrow-down"></i></div>
                        
                        <div class="workflow-item">
                            <div class="workflow-icon"><i class="fas fa-tools"></i></div>
                            <div class="workflow-text">
                                <h4>4. Investigate & Resolve</h4>
                                <p>Work on resolving the issue, documenting your actions in comments.</p>
                            </div>
                        </div>
                        
                        <div class="workflow-arrow"><i class="fas fa-arrow-down"></i></div>
                        
                        <div class="workflow-item">
                            <div class="workflow-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="workflow-text">
                                <h4>5. Update Status</h4>
                                <p>Set status to "Resolved" once you've solved the issue.</p>
                            </div>
                        </div>
                    </div>
                    
                    <h3>Filtering and Searching</h3>
                    <p>Use the filters at the top of your dashboard to quickly find tickets by:</p>
                    <ul>
                        <li>Status</li>
                        <li>Priority</li>
                        <li>Category</li>
                    </ul>
                    <p>The search box allows you to find tickets by keyword in title or description.</p>
                </section>
                
                <section id="update-status">
                    <h2>Updating Ticket Status</h2>
                    
                    <h3>Status Changes</h3>
                    <p>You can update a ticket's status in two ways:</p>
                    
                    <div class="screenshot-guide">
                        <div class="guide-item">
                            <h4>From the Ticket View</h4>
                            <ol>
                                <li>Open the ticket by clicking "View" on your dashboard</li>
                                <li>Click the "Update Ticket" button at the bottom</li>
                                <li>Select the new status from the dropdown menu</li>
                                <li>Add a comment explaining the status change</li>
                                <li>Click "Update Ticket" to save changes</li>
                            </ol>
                        </div>
                        
                        <div class="guide-item">
                            <h4>Quick Update from Dashboard</h4>
                            <ol>
                                <li>Locate the ticket on your dashboard</li>
                                <li>Click the "Update" button</li>
                                <li>Select the new status in the popup modal</li>
                                <li>Add a comment</li>
                                <li>Click "Save Changes"</li>
                            </ol>
                        </div>
                    </div>
                    
                    <h3>When to Change Status</h3>
                    <div class="status-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Change To</th>
                                    <th>When</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>In Progress</td>
                                    <td>When you start working on the ticket</td>
                                </tr>
                                <tr>
                                    <td>Resolved</td>
                                    <td>When you've implemented a solution and verified it works</td>
                                </tr>
                                <tr>
                                    <td>Closed</td>
                                    <td>When the user confirms the solution works (or after 7 days with no response)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <section id="communication">
                    <h2>Communication Best Practices</h2>
                    
                    <h3>Writing Effective Comments</h3>
                    <p>Good communication is essential for efficient ticket resolution:</p>
                    <ul>
                        <li>Be clear, concise, and professional</li>
                        <li>Use simple language, avoiding technical jargon when possible</li>
                        <li>Structure your response with bullet points for clarity</li>
                        <li>Include step-by-step instructions when providing solutions</li>
                        <li>End with a clear question if you need more information</li>
                    </ul>
                    
                    <div class="example-container">
                        <div class="example good">
                            <h4>Good Example</h4>
                            <div class="example-content">
                                <p>Hi John,</p>
                                <p>I've investigated the login issue you reported. The problem appears to be related to your account settings.</p>
                                <p>To fix this, please try these steps:</p>
                                <ol>
                                    <li>Clear your browser cookies and cache</li>
                                    <li>Try logging in again</li>
                                    <li>If the problem persists, try using a different browser</li>
                                </ol>
                                <p>Could you let me know if these steps resolve your issue?</p>
                            </div>
                        </div>
                        
                        <div class="example bad">
                            <h4>Poor Example</h4>
                            <div class="example-content">
                                <p>Fixed it. Try now.</p>
                            </div>
                        </div>
                    </div>
                    
                    <h3>Response Times</h3>
                    <p>Aim to meet or exceed these response time guidelines:</p>
                    <ul>
                        <li>Initial response: within 4 hours</li>
                        <li>Follow-up questions: within 24 hours</li>
                        <li>Status updates: at least every 48 hours for open tickets</li>
                    </ul>
                </section>
            <% } %>
            
            <% if (userRole === '2nd Line') { %>
                <section id="advanced-support">
                    <h2>Advanced Support Techniques</h2>
                    
                    <h3>Handling Escalated Tickets</h3>
                    <p>As 2nd Line support, you'll often receive escalated tickets that couldn't be resolved by 1st Line support:</p>
                    <ol>
                        <li>Always review the full ticket history before responding</li>
                        <li>Acknowledge previous troubleshooting efforts</li>
                        <li>Focus on deeper technical investigation</li>
                        <li>Document your findings thoroughly for knowledge sharing</li>
                    </ol>
                    
                    <h3>Technical Documentation</h3>
                    <p>Create comprehensive technical documentation when solving complex issues:</p>
                    <ul>
                        <li>Root cause analysis</li>
                        <li>Detailed solution steps</li>
                        <li>Any code or configuration changes made</li>
                        <li>Recommendations for preventing similar issues</li>
                    </ul>
                    <p>This documentation helps build the knowledge base and assists 1st Line support in handling similar issues in the future.</p>
                </section>
            <% } %>
            
            <% if (userRole === 'Admin') { %>
                <section id="admin-guide">
                    <h2>Administrator Guide</h2>
                    <p>As an administrator, you have full access to manage users, tickets, and system settings.</p>
                    
                    <h3>Admin Dashboard</h3>
                    <p>Your dashboard provides a complete overview of the system, including:</p>
                    <ul>
                        <li>All tickets across the system</li>
                        <li>User management tools</li>
                        <li>Analytics and reporting</li>
                    </ul>
                </section>
                
                <section id="user-management">
                    <h2>User Management</h2>
                    <p>Access the User Management page through the admin dashboard to:</p>
                    
                    <h3>Managing User Roles</h3>
                    <ol>
                        <li>Navigate to User Management</li>
                        <li>Find the user in the list</li>
                        <li>Select the appropriate role from the dropdown</li>
                        <li>Click "Update" to apply the change</li>
                    </ol>
                    
                    <h3>Available Roles</h3>
                    <ul>
                        <li><strong>Admin:</strong> Full system access</li>
                        <li><strong>2nd Line:</strong> Advanced technical support staff</li>
                        <li><strong>1st Line:</strong> Front-line support staff</li>
                        <li><strong>User:</strong> Standard user who can create and track tickets</li>
                    </ul>
                </section>
                
                <section id="ticket-assignment">
                    <h2>Ticket Assignment</h2>
                    <p>Efficiently assign tickets to appropriate support staff:</p>
                    
                    <h3>Assignment Process</h3>
                    <ol>
                        <li>View unassigned tickets in your admin dashboard</li>
                        <li>Click the "Assign" button next to a ticket</li>
                        <li>Select the support level (1st or 2nd Line)</li>
                        <li>Choose a specific support staff member</li>
                        <li>Click "Assign" to complete the process</li>
                    </ol>
                    
                    <h3>Assignment Guidelines</h3>
                    <p>Follow these guidelines when assigning tickets:</p>
                    <ul>
                        <li>Assign basic issues to 1st Line support</li>
                        <li>Assign complex technical issues to 2nd Line support</li>
                        <li>Consider current workload and expertise when selecting staff members</li>
                        <li>Balance the workload across the support team</li>
                    </ul>
                </section>
                
                <section id="analytics">
                    <h2>Analytics and Reporting</h2>
                    <p>Use the analytics page to track system performance and identify improvement opportunities.</p>
                    
                    <h3>Available Reports</h3>
                    <ul>
                        <li>Ticket volume by status, priority, and category</li>
                        <li>Support team performance metrics</li>
                        <li>Resolution time analysis</li>
                        <li>User activity reports</li>
                    </ul>
                    
                    <h3>Using Analytics for Decision-Making</h3>
                    <p>Analytics can help you:</p>
                    <ul>
                        <li>Identify training needs for support staff</li>
                        <li>Detect common issues that might need systemic fixes</li>
                        <li>Balance workload across support teams</li>
                        <li>Track support quality and performance over time</li>
                    </ul>
                </section>
            <% } %>
        </div>
    </div>
</div>

<style>
    .manual-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .manual-header {
        margin-bottom: 30px;
        border-bottom: 1px solid #444;
        padding-bottom: 15px;
    }
    
    .manual-content {
        display: flex;
        gap: 30px;
    }
    
    .toc {
        flex: 0 0 250px;
        background-color: #2a2a2a;
        border-radius: 8px;
        padding: 20px;
        position: sticky;
        top: 20px;
        align-self: flex-start;
        max-height: 80vh;
        overflow-y: auto;
    }
    
    .toc-header {
        font-size: 1.2rem;
        font-weight: bold;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #444;
        color: #fff;
    }
    
    .toc ul {
        list-style-type: none;
        padding: 0;
        margin: 0;
    }
    
    .toc li {
        margin-bottom: 10px;
    }
    
    .toc a {
        color: #4da6ff;
        text-decoration: none;
        transition: color 0.2s;
    }
    
    .toc a:hover {
        color: #2196F3;
    }
    
    .manual-sections {
        flex: 1;
    }
    
    section {
        background-color: #2a2a2a;
        border-radius: 8px;
        padding: 25px;
        margin-bottom: 30px;
    }
    
    h2 {
        color: #fff;
        margin-top: 0;
        margin-bottom: 20px;
        border-bottom: 1px solid #444;
        padding-bottom: 10px;
    }
    
    h3 {
        color: #4da6ff;
        margin-top: 30px;
        margin-bottom: 15px;
    }
    
    h4 {
        color: #eee;
        margin-top: 20px;
        margin-bottom: 10px;
    }
    
    p, ul, ol {
        color: #ccc;
        line-height: 1.6;
    }
    
    ul, ol {
        margin-bottom: 20px;
        padding-left: 25px;
    }
    
    li {
        margin-bottom: 5px;
    }
    
    .status-explanation {
        margin-top: 15px;
        margin-bottom: 25px;
    }
    
    .status-item {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }
    
    .status-item p {
        margin: 0 0 0 15px;
    }
    
    .status-badge, .priority-badge {
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 0.8rem;
        min-width: 80px;
        text-align: center;
    }
    
    .status-åpen {
        background-color: #2196F3;
        color: white;
    }
    
    .status-under-arbeid {
        background-color: #ff9800;
        color: white;
    }
    
    .status-løst {
        background-color: #4CAF50;
        color: white;
    }
    
    .status-closed {
        background-color: #9e9e9e;
        color: white;
    }
    
    .priority-high {
        background-color: #f44336;
        color: white;
    }
    
    .priority-medium {
        background-color: #ff9800;
        color: white;
    }
    
    .priority-low {
        background-color: #4CAF50;
        color: white;
    }
    
    .guide-img {
        margin: 20px 0;
        text-align: center;
    }
    
    .guide-img img {
        max-width: 100%;
        border-radius: 8px;
        border: 1px solid #444;
    }
    
    .caption {
        font-size: 0.9rem;
        color: #999;
        margin-top: 10px;
    }
    
    .steps {
        margin: 25px 0;
    }
    
    .step {
        display: flex;
        margin-bottom: 25px;
    }
    
    .step-number {
        background-color: #2196F3;
        color: white;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        margin-right: 15px;
        flex-shrink: 0;
    }
    
    .step-content {
        flex: 1;
    }
    
    .step-content h4 {
        margin-top: 0;
    }
    
    .workflow {
        margin: 30px 0;
    }
    
    .workflow-item {
        display: flex;
        align-items: center;
        background-color: #333;
        padding: 15px;
        border-radius: 8px;
    }
    
    .workflow-icon {
        font-size: 2rem;
        color: #2196F3;
        margin-right: 20px;
        width: 50px;
        text-align: center;
    }
    
    .workflow-text {
        flex: 1;
    }
    
    .workflow-text h4 {
        margin-top: 0;
        margin-bottom: 5px;
    }
    
    .workflow-text p {
        margin: 0;
    }
    
    .workflow-arrow {
        text-align: center;
        font-size: 1.5rem;
        color: #555;
        margin: 10px 0;
    }
    
    .screenshot-guide {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }
    
    .guide-item {
        flex: 1;
        min-width: 300px;
    }
    
    .status-table {
        margin: 20px 0;
    }
    
    .status-table table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .status-table th, .status-table td {
        padding: 12px 15px;
        border-bottom: 1px solid #444;
        text-align: left;
    }
    
    .status-table th {
        background-color: #333;
    }
    
    .example-container {
        display: flex;
        gap: 20px;
        margin: 20px 0;
        flex-wrap: wrap;
    }
    
    .example {
        flex: 1;
        min-width: 300px;
        padding: 15px;
        border-radius: 8px;
    }
    
    .example h4 {
        margin-top: 0;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #444;
    }
    
    .good {
        background-color: rgba(76, 175, 80, 0.1);
        border: 1px solid rgba(76, 175, 80, 0.3);
    }
    
    .bad {
        background-color: rgba(244, 67, 54, 0.1);
        border: 1px solid rgba(244, 67, 54, 0.3);
    }
    
    @media (max-width: 992px) {
        .manual-content {
            flex-direction: column;
        }
        
        .toc {
            position: static;
            max-height: none;
        }
    }
</style>

<script>
    // Smooth scrolling for anchor links
    document.querySelectorAll('.toc a').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            
            const targetId = this.getAttribute('href');
            const targetSection = document.querySelector(targetId);
            
            if (targetSection) {
                window.scrollTo({
                    top: targetSection.offsetTop - 20,
                    behavior: 'smooth'
                });
            }
        });
    });
</script>

<%- include('./partials/footer') %>
